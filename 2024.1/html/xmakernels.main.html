<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
<!-- End Google Tag Manager -->
  <title>XMA Upper Edge API Library &mdash; XRT Master documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
      <link rel="stylesheet" href="_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="XMA Lower Edge API Library" href="xma.main.html" />
    <link rel="prev" title="Plugin Development Guide" href="xma_plugin_dev.html" /> 
</head>

<body class="wy-body-for-nav">

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
<!-- End Google Tag Manager --> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="index.html" class="icon icon-home"> XRT
            <img src="_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Master
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="platforms.html">XRT and Vitis™ Platform Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="system_requirements.html">System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Building the XRT Software Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">XRT Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="test.html">Developer Build and Test Instructions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use Model and Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="execution-model.html">Execution Model Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="xrt_kernel_executions.html">XRT Controlled Kernel Execution Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiprocess.html">Multi-Process Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="p2p.html">PCIe Peer-to-Peer (P2P)</a></li>
<li class="toctree-l1"><a class="reference internal" href="m2m.html">Memory-to-Memory (M2M)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hm.html">Host Memory Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="xrt_ini.html">Configuration File xrt.ini</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Video Acceleration Using XMA</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="xma_user_guide.html">XMA Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="xma_apps_dev.html">Application Development Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="xma_plugin_dev.html">Plugin Development Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">XMA Upper Edge API Library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#encoder">Encoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="#decoder">Decoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scaler">Scaler</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filter">Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#kernel">Kernel</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="xma.main.html">XMA Lower Edge API Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="xma_19.2.html">Migration from Legacy XMA</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User API Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="opencl_extension.html">Xilinx OpenCL extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="xrt_native_apis.html">XRT Native APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="xrt_native.main.html">XRT Native Library C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="xrt_native.main.html#id1">XRT Native Library C API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">XRT Developer's Space</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="platforms_partitions.html">Alveo™ Platform Loading Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="sysfs.html">Linux Sys FileSystem Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats.html">Binary Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="ert.main.html">Embedded Runtime Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="mgmt-ioctl.main.html">XCLMGMT (PCIe Management Physical Function) Driver Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="xocl_ioctl.main.html">XOCL (PCIe User Physical Function) Driver Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="zocl_ioctl.main.html">ZOCL Driver Interfaces</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools and Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="xclbintools.html">xclbinutil</a></li>
<li class="toctree-l1"><a class="reference internal" href="xbutil.html">xbutil</a></li>
<li class="toctree-l1"><a class="reference internal" href="xbmgmt.html">xbmgmt</a></li>
<li class="toctree-l1"><a class="reference internal" href="xbflash2.html">xbflash2</a></li>
<li class="toctree-l1"><a class="reference internal" href="xball.html">xball</a></li>
<li class="toctree-l1"><a class="reference internal" href="xbtop.html">xbtop</a></li>
<li class="toctree-l1"><a class="reference internal" href="xbtools_map.html">Utility Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="nagios_plugin.html">xrt nagios plugin</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Building Platforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="yocto.html">XRT Setup for Embedded Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="test.html">Developer Build and Test Instructions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Cloud Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mailbox.main.html">Mailbox Subdevice Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="mailbox.proto.html">Mailbox Inter-domain Communication Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloud_vendor_support.html">MSD/MPD and Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="fpga_device_ready.html">FPGA device readiness within user VM</a></li>
<li class="toctree-l1"><a class="reference internal" href="vsec.html">Accessing vsec within VM</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Security</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security of Alveo Platform</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python binding</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyxrt.html">XRT Python Bindings</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Debug and Faqs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="debug-faq.html">XRT/Board Debug FAQ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">XRT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>XMA Upper Edge API Library</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/xmakernels.main.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="xmakernels-main-rst"></span><section id="xma-upper-edge-api-library">
<h1>XMA Upper Edge API Library<a class="headerlink" href="#xma-upper-edge-api-library" title="Permalink to this headline">¶</a></h1>
<p><strong>XMA Application Interface</strong></p>
<p>The interface used by stand-alone XMA applications or plugins</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_initialize">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_initialize</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaXclbinParameter</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">devXclbins</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n"><span class="pre">num_parms</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_initialize" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initialie XMA Library and devices</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaXclbinParameter</span> <span class="pre">*</span> <span class="pre">devXclbins</span></code></dt><dd><p>array of device index and full path of xclbin to program the device with.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int32_t</span> <span class="pre">num_parms</span></code></dt><dd><p>Number of elements in above array input</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>This is the entry point routine for utilzing the XMA library and must be
the first call within any application before calling any other XMA APIs.
Each device specified will be  programmed with provided xclbin(s).</p>
</div></blockquote>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS or XMa_ERROR</p>
<p><strong>XMA upper edge APIs can be divided based on the following five types of kernel</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Encoder</p></li>
<li><p>Decoder</p></li>
<li><p>Scaler</p></li>
<li><p>Filter</p></li>
<li><p>Kernel (generic type)</p></li>
</ol>
</div></blockquote>
<section id="encoder">
<h2>Encoder<a class="headerlink" href="#encoder" title="Permalink to this headline">¶</a></h2>
<p><strong>Introduction</strong></p>
<blockquote>
<div><p>The Xilinx media encoder API is comprised of two distinct interfaces:
one interface for an external framework such as FFmpeg or a proprietary
multi-media framework and the plugin interface used by Xilinx
accelerator developers.  This section illustrates both interfaces
starting with the external framework view and moving on to the plugin
developers view.</p>
<p>The external interface to the Xilinx video encoder is comprised of the
following functions:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#c.xma_enc_session_create" title="xma_enc_session_create"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_enc_session_create()</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.xma_enc_session_destroy" title="xma_enc_session_destroy"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_enc_session_destroy()</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.xma_enc_session_send_frame" title="xma_enc_session_send_frame"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_enc_session_send_frame()</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.xma_enc_session_recv_data" title="xma_enc_session_recv_data"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_enc_session_recv_data()</span></code></a></p></li>
</ol>
<p>A media framework (such as FFmpeg) is responsible for creating an encoder
session.  The encoder session contains state information used by the
encoder plugin to manage the hardware associated with a Xilinx accelerator
device.  Prior to creating an encoder session the media framework is
responsible for initializing the XMA using the function
<a class="reference internal" href="#c.xma_initialize" title="xma_initialize"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_initialize()</span></code></a>.  The initialize function should be called by the
media framework early in the framework initialization to ensure that all
resources have been configured.  Ideally, the  <a class="reference internal" href="#c.xma_initialize" title="xma_initialize"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_initialize()</span></code></a>
function should be called from the <code class="xref c c-func docutils literal notranslate"><span class="pre">main()</span></code> function of the media framework
in order to guarantee it is only called once.</p>
</div></blockquote>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">enum</span> <span class="pre">XmaEncoderType</span></span></dt>
<dd><p>Value specifies the precise type of encoder kernel requested</p>
</dd></dl>

<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XMA_H264_ENCODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_HEVC_ENCODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_VP9_ENCODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_AV1_ENCODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_COPY_ENCODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_JPG_ENCODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_MULTI_ENCODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
</dl>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">struct</span> <span class="pre">XmaEncoderProperties</span></span></dt>
<dd><p>Properities used to specify which encoder is requested and how the encoder should be initalized by the plugin driver</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct XmaEncoderProperties {
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_enc_session_create">
<span class="n"><span class="pre">XmaEncoderSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xma_enc_session_create</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaEncoderProperties</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">enc_props</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_enc_session_create" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function creates an encoder session and must be called prior to encoding a frame. A session reserves hardware resources for the duration of a video stream. The number of sessions allowed depends on a number of factors that include: resolution, frame rate, bit depth, and the capabilities of the hardware accelerator.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaEncoderProperties</span> <span class="pre">*</span> <span class="pre">enc_props</span></code></dt><dd><p>Pointer to a XmaEncoderProperties structure that
contains the key configuration properties needed for
finding available hardware resource.</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>Not NULL on success</p>
<p>NULL on failure</p>
<p><strong>Note</strong></p>
<p>session create &amp; destroy are thread safe APIs</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_enc_session_destroy">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_enc_session_destroy</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaEncoderSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_enc_session_destroy" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function destroys an encoder session that was previously created with the xm_enc_session_create function.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaEncoderSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to XmaEncoderSession created with
xma_enc_session_create</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success</p>
<p>XMA_ERROR on failure.</p>
<p><strong>Note</strong></p>
<p>session create &amp; destroy are thread safe APIs</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_enc_session_send_frame">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_enc_session_send_frame</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaEncoderSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span>, <span class="n"><span class="pre">XmaFrame</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">frame</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_enc_session_send_frame" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function invokes plugin-&gt;send_frame fucntion assigned to this session which handles sending data to the hardware decoder.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaEncoderSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to session created by xm_enc_sesssion_create</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XmaFrame</span> <span class="pre">*</span> <span class="pre">frame</span></code></dt><dd><p>Pointer to a frame to be encoded.  If the encoder
has buffered input, the input will need to be flushed.  To do so,
an XmaFrame with a null pointer to the first data buffer will need
to be sent until XMA_EOS is received (XmaFrame.data[0].buffer = NULL).</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Plugin and media framework (like FFMPEG) may handle events like
errors, no empty lookup buffer, no output data, end of input stream, etc using
XMA_FLUSH_AGAIN, XMA_TRY_AGAIN, XMA_SEND_MORE_DATA, XMA_EOS,
XMA_ERROR, etc return codes</p>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success; indicates that sufficient data has
been received to begin producing output</p>
<p>XMA_SEND_MORE_DATA if additional frames are needed before
output can be received</p>
<p>XMA_ERROR on error</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_enc_session_recv_data">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_enc_session_recv_data</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaEncoderSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span>, <span class="n"><span class="pre">XmaDataBuffer</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_enc_session_recv_data" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function invokes plugin-&gt;recv_data assigned to this session which handles obtaining output data from the hardware encoder. This function returns a data buffer along with the length of the buffer if one is available. This function is called after calling the function xm_enc_session_send_frame. If a data buffer is not ready to be returned, this function returns -1 and sets the length of the data buffer to 0. In addition, the data buffer pointer is set to NULL. If a data buffer is ready, the data_size will be set with a non-zero value and a pointer to the data buffer will be set to a non-NULL value.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaEncoderSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to session created by xm_enc_sesssion_create</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XmaDataBuffer</span> <span class="pre">*</span> <span class="pre">data</span></code></dt><dd><p>Pointer to a data buffer containing encoded data</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int32_t</span> <span class="pre">*</span> <span class="pre">data_size</span></code></dt><dd><p>Pointer to hold the size of the data buffer returned</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success.</p>
<p>XMA_EOS when all data has been flushed from the encoder</p>
<p>XMA_ERROR on error.</p>
</section>
<section id="decoder">
<h2>Decoder<a class="headerlink" href="#decoder" title="Permalink to this headline">¶</a></h2>
<p><strong>Introduction</strong></p>
<blockquote>
<div><p>The Xilinx media decoder API is comprised of two distinct interfaces:
one interface for an external framework such as FFmpeg or a proprietary
multi-media framework and the plugin interface used by Xilinx
accelerator developers.  This section illustrates both interfaces
starting with the external framework view and moving on to the plugin
developers view.</p>
<p>The external interface to the Xilinx video decoder is comprised of the
following functions:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#c.xma_dec_session_create" title="xma_dec_session_create"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_dec_session_create()</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.xma_dec_session_destroy" title="xma_dec_session_destroy"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_dec_session_destroy()</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.xma_dec_session_send_data" title="xma_dec_session_send_data"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_dec_session_send_data()</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.xma_dec_session_get_properties" title="xma_dec_session_get_properties"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_dec_session_get_properties()</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.xma_dec_session_recv_frame" title="xma_dec_session_recv_frame"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_dec_session_recv_frame()</span></code></a></p></li>
</ol>
<p>A media framework (such as FFmpeg) is responsible for creating a decoder
session.  The decoder session contains state information used by the
decoder plugin to manage the hardware associated with a Xilinx accelerator
device.  Prior to creating an decoder session the media framework is
responsible for initializing the XMA using the function
<a class="reference internal" href="#c.xma_initialize" title="xma_initialize"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_initialize()</span></code></a>.  The initialize function should be called by the
media framework early in the framework initialization to ensure that all
resources have been configured.  Ideally, the <a class="reference internal" href="#c.xma_initialize" title="xma_initialize"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_initialize()</span></code></a>
function should be called from the <code class="xref c c-func docutils literal notranslate"><span class="pre">main()</span></code> function of the media framework
in order to guarantee it is only called once.</p>
</div></blockquote>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">enum</span> <span class="pre">XmaDecoderType</span></span></dt>
<dd><p>A decoder from this list forms part of a request for a specific decoder when creating a decoder session via xma_dec_session_create.</p>
</dd></dl>

<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XMA_H264_DECODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_HEVC_DECODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_VP9_DECODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_AV1_DECODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_JPG_DECODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_MULTI_DECODER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
</dl>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">struct</span> <span class="pre">XmaDecoderProperties</span></span></dt>
<dd><p>Properities used to specify which decoder is requested and how the decoder should be initalized by the plugin driver</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct XmaDecoderProperties {
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_dec_session_create">
<span class="n"><span class="pre">XmaDecoderSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xma_dec_session_create</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaDecoderProperties</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dec_props</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_dec_session_create" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function creates a decoder session and must be called prior to decoding data. A session reserves hardware resources for the duration of a video stream. The number of sessions allowed depends on a number of factors that include: resolution, frame rate, bit depth, and the capabilities of the hardware accelerator.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaDecoderProperties</span> <span class="pre">*</span> <span class="pre">dec_props</span></code></dt><dd><p>Pointer to a XmaDecoderProperties structure that
contains the key configuration properties, device &amp; cu index, etc</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>Not NULL on success</p>
<p>NULL on failure</p>
<p><strong>Note</strong></p>
<p>session create &amp; destroy are thread safe APIs</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_dec_session_destroy">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_dec_session_destroy</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaDecoderSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_dec_session_destroy" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function destroys a decoder session that was previously created with the xma_dec_session_create function.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaDecoderSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to XmaDecoderSession created with
xma_dec_session_create</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success</p>
<p>XMA_ERROR on failure.</p>
<p><strong>Note</strong></p>
<p>session create &amp; destroy are thread safe APIs</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_dec_session_send_data">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_dec_session_send_data</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaDecoderSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span>, <span class="n"><span class="pre">XmaDataBuffer</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data_used</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_dec_session_send_data" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function invokes plugin-&gt;send_data fucntion assigned to this session which handles sending data to the hardware decoder.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaDecoderSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to session created by xma_dec_sesssion_create</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XmaDataBuffer</span> <span class="pre">*</span> <span class="pre">data</span></code></dt><dd><p>Pointer to a data buffer to be decoded</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int32_t</span> <span class="pre">*</span> <span class="pre">data_used</span></code></dt><dd><p>Pointer to an integer to receive the amount of data used</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Plugin and media framework (like FFMPEG) may handle events like
errors, no empty lookup buffer, no output data, end of input stream, etc using
XMA_FLUSH_AGAIN, XMA_TRY_AGAIN, XMA_SEND_MORE_DATA, XMA_EOS,
XMA_ERROR, etc return codes</p>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success.</p>
<p>XMA_ERROR on error.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_dec_session_get_properties">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_dec_session_get_properties</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaDecoderSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dec_session</span></span>, <span class="n"><span class="pre">XmaFrameProperties</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fprops</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_dec_session_get_properties" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function invokes plugin-&gt;get_properties assigned to this session which returns properties of the hardware decoder.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaDecoderSession</span> <span class="pre">*</span> <span class="pre">dec_session</span></code></dt><dd><p>Pointer to session created by xma_dec_sesssion_create</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XmaFrameProperties</span> <span class="pre">*</span> <span class="pre">fprops</span></code></dt><dd><p>Pointer to a frame properties structure to be filled in</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success.</p>
<p>XMA_ERROR on error.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_dec_session_recv_frame">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_dec_session_recv_frame</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaDecoderSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span>, <span class="n"><span class="pre">XmaFrame</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">frame</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_dec_session_recv_frame" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function invokes plugin-&gt;recv_frame assigned to this session which handles obtaining output frame from the hardware decoder. This function returns a frame if one is available.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaDecoderSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to session created by xma_dec_sesssion_create</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XmaFrame</span> <span class="pre">*</span> <span class="pre">frame</span></code></dt><dd><p>Pointer to a frame containing decoded data</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>This function is called after calling the function xma_dec_session_send_data.
If a frame is not ready to be returned, plugin function should return -1.  In addition, the</p>
<blockquote>
<div><p>frame pointer should be set to NULL.  If a frame is ready, a pointer to the frame
will be set to a non-NULL value.</p>
</div></blockquote>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success.</p>
<p>XMA_ERROR on error.</p>
</section>
<section id="scaler">
<h2>Scaler<a class="headerlink" href="#scaler" title="Permalink to this headline">¶</a></h2>
<p><strong>Introduction</strong></p>
<blockquote>
<div><p>The Xilinx media scaler API is comprised of two distinct interfaces:
one interface for an external framework such as FFmpeg or a proprietary
multi-media framework and the plugin interface used by Xilinx
accelerator developers.  This section illustrates both interfaces
starting with the external framework view and moving on to the plugin
developers view.</p>
<p>The external interface to the Xilinx video scaler is comprised of the
following functions:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#c.xma_scaler_session_create" title="xma_scaler_session_create"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_scaler_session_create()</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.xma_scaler_session_destroy" title="xma_scaler_session_destroy"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_scaler_session_destroy()</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.xma_scaler_session_send_frame" title="xma_scaler_session_send_frame"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_scaler_session_send_frame()</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.xma_scaler_session_recv_frame_list" title="xma_scaler_session_recv_frame_list"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_scaler_session_recv_frame_list()</span></code></a></p></li>
</ol>
<p>A media framework (such as FFmpeg) is responsible for creating a scaler
session.  The scaler session contains state information used by the
scaler plugin to manage the hardware associated with a Xilinx accelerator
device.  Prior to creating a scaler session the media framework is
responsible for initializing the XMA using the function
<strong>ref</strong> <a class="reference internal" href="#c.xma_initialize" title="xma_initialize"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_initialize()</span></code></a>.  The initialize function should be called by the
media framework early in the framework initialization to ensure that all
resources have been configured.  Ideally, the <strong>ref</strong> <a class="reference internal" href="#c.xma_initialize" title="xma_initialize"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_initialize()</span></code></a>
function should be called from the <code class="xref c c-func docutils literal notranslate"><span class="pre">main()</span></code> function of the media framework
in order to guarantee it is only called once.</p>
</div></blockquote>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">enum</span> <span class="pre">XmaScalerType</span></span></dt>
<dd><p>Specific type of scaler to request</p>
</dd></dl>

<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XMA_BICUBIC_SCALER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_BILINEAR_SCALER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XMA_POLYPHASE_SCALER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
</dl>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">struct</span> <span class="pre">XmaScalerInOutProperties</span></span></dt>
<dd><p>Properties which shall be used to specify configuration of kernel input or output as applicable</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct XmaScalerInOutProperties {
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">struct</span> <span class="pre">XmaScalerFilterProperties</span></span></dt>
<dd><p>Filter coefficients to be used by kernel</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct XmaScalerFilterProperties {
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">struct</span> <span class="pre">XmaScalerProperties</span></span></dt>
<dd><p>Properties structure used to request filter type and vendor as well as the manner in which it should be inialized by the plugin</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct XmaScalerProperties {
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_scaler_default_filter_coeff_set">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_scaler_default_filter_coeff_set</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaScalerFilterProperties</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">props</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_scaler_default_filter_coeff_set" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This helper function sets the default horizontal and vertical filter coefficients for a polyphase filter bank.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaScalerFilterProperties</span> <span class="pre">*</span> <span class="pre">props</span></code></dt><dd><p>Pointer to a XmaScalerFilterProperties structure that
will contain the filter coefficients.</p>
</dd>
</dl>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_scaler_session_create">
<span class="n"><span class="pre">XmaScalerSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xma_scaler_session_create</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaScalerProperties</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">props</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_scaler_session_create" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function creates a scaler session and must be called prior to scaling a frame. A session reserves hardware resources for the duration of a video stream. The number of sessions allowed depends on a number of factors that include: resolution, frame rate, bit depth, and the capabilities of the hardware accelerator.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaScalerProperties</span> <span class="pre">*</span> <span class="pre">props</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p><strong>props</strong> Pointer to a XmaScalerProperties structure that
contains the key configuration properties needed for
finding available hardware resource.</p>
</div></blockquote>
<p><strong>Return</strong></p>
<p>Not NULL on success</p>
<p>NULL on failure</p>
<p><strong>Note</strong></p>
<p>session create &amp; destroy are thread safe APIs</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_scaler_session_destroy">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_scaler_session_destroy</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaScalerSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_scaler_session_destroy" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function destroys an scaler session that was previously created with the <a class="reference internal" href="#c.xma_scaler_session_create" title="xma_scaler_session_create"><code class="xref c c-func docutils literal notranslate"><span class="pre">xma_scaler_session_create()</span></code></a> function.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaScalerSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to XmaScalerSession created with
xma_scaler_session_create</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success</p>
<p>XMA_ERROR on failure.</p>
<p><strong>Note</strong></p>
<p>session create &amp; destroy are thread safe APIs</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_scaler_session_send_frame">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_scaler_session_send_frame</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaScalerSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span>, <span class="n"><span class="pre">XmaFrame</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">frame</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_scaler_session_send_frame" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function invokes plugin-&gt;send_frame fucntion assigned to this session which handles sending data to the hardware scaler.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaScalerSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to session created by xma_scaler_sesssion_create</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XmaFrame</span> <span class="pre">*</span> <span class="pre">frame</span></code></dt><dd><p>Pointer to a frame to be scaled.  If the scaler is
buffering input, then an XmaFrame with a NULL data buffer
pointer to the first data buffer must be sent to flush the filter and
to indicate that no more data will be sent:
XmaFrame.data[0].buffer = NULL
The application must then check for XMA_FLUSH_AGAIN for each such call
when flushing the last few frames.  When XMA_EOS is returned, no new
data may be collected from the scaler.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<dl class="simple">
<dt>This function sends a frame to the hardware scaler.  If a frame</dt><dd><p>buffer is not available, the plugin function should block.</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success and the scaler is ready to
produce output</p>
<p>XMA_SEND_MORE_DATA if the scaler is buffering input frames</p>
<p>XMA_FLUSH_AGAIN when flushing scaler with a null frame</p>
<p>XMA_EOS when the scaler has been flushed of all residual frames</p>
<p>XMA_ERROR on error</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_scaler_session_recv_frame_list">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_scaler_session_recv_frame_list</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaScalerSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span>, <span class="n"><span class="pre">XmaFrame</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">frame_list</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_scaler_session_recv_frame_list" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function invokes plugin-&gt;recv_frame_list assigned to this session which handles obtaining list of output frames from the hardware encoder. This function is called after calling the function xma_scaler_session_send_frame. If a data buffer is not ready to be returned, the plugin function should blocks.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaScalerSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to session created by xma_scaler_sesssion_create</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XmaFrame</span> <span class="pre">**</span> <span class="pre">frame_list</span></code></dt><dd><p>Pointer to a list of XmaFrame structures</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success</p>
<p>XMA_ERROR on error</p>
</section>
<section id="filter">
<h2>Filter<a class="headerlink" href="#filter" title="Permalink to this headline">¶</a></h2>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">enum</span> <span class="pre">XmaFilterType</span></span></dt>
<dd><p>Identifier specifying precise type of video filter during session creation</p>
</dd></dl>

<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XMA_2D_FILTER_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
</dl>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">struct</span> <span class="pre">XmaFilterPortProperties</span></span></dt>
<dd><p>Properties necessary for specifying how an input or output port should be configured by the plugin.</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct XmaFilterPortProperties {
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">struct</span> <span class="pre">XmaFilterProperties</span></span></dt>
<dd><p>Properties necessary for specifying which filter kernel to select and how it should be configured by the plugin.</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct XmaFilterProperties {
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_filter_session_create">
<span class="n"><span class="pre">XmaFilterSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xma_filter_session_create</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaFilterProperties</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">props</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_filter_session_create" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function creates a filter session and must be called prior to filtering a frame. A session reserves hardware resources for the duration of a video stream. The number of sessions allowed depends on a number of factors that include: resolution, frame rate, bit depth, and the capabilities of the hardware accelerator.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaFilterProperties</span> <span class="pre">*</span> <span class="pre">props</span></code></dt><dd><p>Pointer to a XmaFilterProperties structure that
contains the key configuration properties needed for
finding available hardware resource.</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>Not NULL on success</p>
<p>NULL on failure</p>
<p><strong>Note</strong></p>
<p>session create &amp; destroy are thread safe APIs</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_filter_session_destroy">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_filter_session_destroy</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaFilterSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_filter_session_destroy" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function destroys an filter session that was previously created with the <strong>ref</strong> xma_filter_session_create function.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaFilterSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to XmaFilterSession created with xma_filter_session_create</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success</p>
<p>XMA_ERROR on failure.</p>
<p><strong>Note</strong></p>
<p>session create &amp; destroy are thread safe APIs</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_filter_session_send_frame">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_filter_session_send_frame</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaFilterSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span>, <span class="n"><span class="pre">XmaFrame</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">frame</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_filter_session_send_frame" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function invokes plugin-&gt;send_frame fucntion assigned to this session which handles sending frames to the hardware decoder.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaFilterSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to session created by xma_filter_session_create</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XmaFrame</span> <span class="pre">*</span> <span class="pre">frame</span></code></dt><dd><p>Pointer to a frame to be filtered. If the filter is
buffering input, then an XmaFrame with a NULL data buffer
pointer to the first data buffer must be sent to flush the filter and
to indicate that no more data will be sent:
XmaFrame.data[0].buffer = NULL
The application must then check for XMA_FLUSH_AGAIN for each such call
when flushing the last few frames.  When XMA_EOS is returned, no new
data may be collected from the filter.</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success and the filter is ready to
produce output</p>
<p>XMA_SEND_MORE_DATA if the filter is buffering input frames</p>
<p>XMA_FLUSH_AGAIN when flushing filter with a null frame</p>
<p>XMA_EOS when the filter has been flushed of all residual frames</p>
<p>XMA_ERROR on error</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_filter_session_recv_frame">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_filter_session_recv_frame</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaFilterSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span>, <span class="n"><span class="pre">XmaFrame</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">frame</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_filter_session_recv_frame" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function invokes plugin-&gt;recv_frame assigned to this session which handles obtaining output frame with filtered data from the hardware filter. This function is called after calling the function xma_filter_session_send_frame. If a data buffer is not ready to be returned, the plugin function should block.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaFilterSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to session created by xma_filter_session_create</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XmaFrame</span> <span class="pre">*</span> <span class="pre">frame</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success.</p>
<p>XMA_ERROR on error.</p>
</section>
<section id="kernel">
<h2>Kernel<a class="headerlink" href="#kernel" title="Permalink to this headline">¶</a></h2>
<p><strong>Introduction</strong></p>
<blockquote>
<div><p>The kernel interface provides a generic method for controlling a kernel
that does not need to send and receive video frame data.  While it is
possible to use the kernel plugin class for video, the class is intended
for cases where only control information is required or the data is not
readily classified as typical video frame data.</p>
<p>In most cases specific to video accelerators, the class of session
typically fits into one of the followeing categories:</p>
<ol class="arabic simple">
<li><p>encoder</p></li>
<li><p>decoder</p></li>
<li><p>filter (with 1 input and 1 output)</p></li>
<li><p>ABR scaler (with 1 input and multiple output)</p></li>
</ol>
<p>Each of the classes above expect frame data as input/output or both.  As a
result, these APIs provide a convenient way to send and/or receive frame
data.  In cases where frame data is not needed or more control over the
type of data sent/recevied is needed, the kernel class of plugin may be a
better fit.  In this case, data is transferred between the host application
and the plugin via private_session_data. private_session_data is managed by host application. As a result, it is up to
the host application and plugin to decide the meaning/structure of the private_session_data.</p>
</div></blockquote>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">enum</span> <span class="pre">XmaKernelType</span></span></dt>
<dd><p>Description of kernel represented by XmaKernel</p>
</dd></dl>

<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XMA_KERNEL_TYPE</span></code></dt><dd><p><em>undescribed</em></p>
</dd>
</dl>
<dl class="c type">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">struct</span> <span class="pre">XmaKernelProperties</span></span></dt>
<dd><p>XmaKernels represent unspecified or custom kernels that may not necessarily fit an existing video kernel type. As such, they may take custom parameters as properties. You should consult the documentation for the kernel plugin to get a list of XmaParameter parameters needed to specify how the kernel should be initalized.</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct XmaKernelProperties {
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_kernel_session_create">
<span class="n"><span class="pre">XmaKernelSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xma_kernel_session_create</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaKernelProperties</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">props</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_kernel_session_create" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function creates a kernel session and must be called prior to invoking other kernel session functions. A session reserves hardware resources until session destroy function is called.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaKernelProperties</span> <span class="pre">*</span> <span class="pre">props</span></code></dt><dd><p>Pointer to a XmaKernelProperties structure that
contains the key configuration properties needed for
finding available hardware resource.</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>Not NULL on success</p>
<p>NULL on failure</p>
<p><strong>Note</strong></p>
<p>session create &amp; destroy are thread safe APIs</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_kernel_session_destroy">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_kernel_session_destroy</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaKernelSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_kernel_session_destroy" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function destroys a kernel session that was previously created with the xma_kernel_session_create function.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaKernelSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to XmaKernelSession created with
xma_kernel_session_create</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success</p>
<p>XMA_ERROR on failure.</p>
<p><strong>Note</strong></p>
<p>session create &amp; destroy are thread safe APIs</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_kernel_session_write">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_kernel_session_write</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaKernelSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span>, <span class="n"><span class="pre">XmaParameter</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">param</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n"><span class="pre">param_cnt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_kernel_session_write" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function invokes plugin-&gt;write fucntion assigned to this session which handles sending data to the hardware kernel. The meaning of the data is managed by the caller and low-level XMA plugin. This means that the data provided could contain information about how kernel registers are programmed, how device DDR memory is set, or some combination of both.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaKernelSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to session created by xm_enc_sesssion_create</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XmaParameter</span> <span class="pre">*</span> <span class="pre">param</span></code></dt><dd><p>Pointer to an XmaParameter list</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int32_t</span> <span class="pre">param_cnt</span></code></dt><dd><p>Number of parameters provided in the list</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success.</p>
<p>XMA_ERROR on error.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.xma_kernel_session_read">
<span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xma_kernel_session_read</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">XmaKernelSession</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">session</span></span>, <span class="n"><span class="pre">XmaParameter</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">param</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">param_cnt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xma_kernel_session_read" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This function invokes plugin-&gt;read assigned to this session which handles obtaining output data from the hardware kernel. The meaning of the data is managed by the caller and low-level XMA plugin.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XmaKernelSession</span> <span class="pre">*</span> <span class="pre">session</span></code></dt><dd><p>Pointer to session created by xm_enc_sesssion_create</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XmaParameter</span> <span class="pre">*</span> <span class="pre">param</span></code></dt><dd><p>Pointer to an XmaParameter</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int32_t</span> <span class="pre">*</span> <span class="pre">param_cnt</span></code></dt><dd><p>Pointer number of parameters in the list</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>XMA_SUCCESS on success.</p>
<p>XMA_ERROR on error.</p>
</section>
</section>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="xma_plugin_dev.html" class="btn btn-neutral float-left" title="Plugin Development Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="xma.main.html" class="btn btn-neutral float-right" title="XMA Lower Edge API Library" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2023, Advanced Micro Devices, Inc.
      <span class="lastupdated">Last updated on October 7, 2022.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>